import{b as V,ag as p,o as $,c as b,a as t,P as u,M as a,u as z,G as F,H as m,L as f,K as R,C as g,i as S,j,S as D,a5 as T,O as h}from"./@vue-JlwsckWB.js";import{a as P,u as q}from"./vue-router-hI8gbx6m.js";import{_ as U}from"./index-D9sq5B9z.js";import"./pinia-91x-qzso.js";import"./vue-demi-Dq6ymT-8.js";import"./element-plus-BCXmXNOW.js";import"./lodash-es-DpRhkxuT.js";import"./@vueuse-DS8A98-V.js";import"./@element-plus-Dbr4-WMN.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-Cvt7qOjS.js";import"./artplayer-DYEsUqgO.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DVIT0l11.js";import"./axios-upsvKRUO.js";import"./vue-cookies-DmNBPvI0.js";import"./@fingerprintjs-BlNouByb.js";import"./tslib-BLN2B0TR.js";import"./vue-cropper-BAfMpYow.js";import"./mitt-DJ65BbbF.js";import"./moment-C5S46NFB.js";const A={class:"video-item",ref:"videoItemRef"},B={class:"video-cover"},M={class:"duration"},K={class:"video-info"},H={class:"video-name"},O={key:0},E={key:2,class:"status waiting"},G={key:3,class:"status fail"},J={class:"video-time"},Q={class:"video-count"},W={class:"iconfont icon-play-solid"},X={class:"iconfont icon-like-solid"},Y={class:"iconfont icon-danmu-solid"},Z={class:"iconfont icon-comment-solid"},tt={class:"iconfont icon-toubi"},ot={class:"iconfont icon-collection-solid"},et={class:"op-panel"},st={class:"more-edit-panel"},at={class:"more-btn-list"},nt={class:"interaction-op"},it={__name:"VideoItem",props:{data:{type:Object,default:{}}},emits:["reload"],setup(s,{emit:_}){const{proxy:l}=S(),v=P(),d=s,y=V(d.data.interaction?d.data.interaction.split(","):[]),I=async C=>{await l.Request({url:l.Api.saveVideoInteraction,params:{videoId:d.data.videoId,interaction:C.join(",")}})},c={editVideo:"/ucenter/editVideo",danmu:"/ucenter/danmu",comment:"/ucenter/comment"},n=C=>{v.push(`${c[C]}?videoId=${d.data.videoId}`)},x=_,k=()=>{l.Confirm({message:`确定要删除【${d.data.videoName}】吗？`,okfun:async()=>{await l.Request({url:l.Api.ucDeleteVideo,params:{videoId:d.data.videoId}})&&(l.Message.success("删除成功"),x("reload"))}})};return(C,o)=>{const r=p("Cover"),e=p("router-link"),N=p("el-checkbox"),w=p("el-checkbox-group"),L=p("el-popover");return $(),b("div",A,[t("div",B,[u(r,{source:s.data.videoCover},null,8,["source"]),t("div",M,a(z(l).Utils.convertSecondsToHMS(s.data.duration)),1)]),t("div",K,[t("div",H,[s.data.status!=3?($(),b("span",O,a(s.data.videoName),1)):($(),F(e,{key:1,to:`/video/${s.data.videoId}`,class:"a-link",target:"_blank"},{default:m(()=>[f(a(s.data.videoName),1)]),_:1},8,["to"])),s.data.status==0||s.data.status==2?($(),b("span",E,a(s.data.statusName),1)):R("",!0),s.data.status==1||s.data.status==4?($(),b("span",G,a(s.data.statusName),1)):R("",!0)]),t("div",J,a(s.data.createTime),1),t("div",Q,[t("span",W,a(s.data.playCount||0),1),t("span",X,a(s.data.likeCount||0),1),t("span",Y,a(s.data.danmuCount||0),1),t("span",Z,a(s.data.commentCount||0),1),t("span",tt,a(s.data.coinCount||0),1),t("span",ot,a(s.data.collectCount||0),1)])]),t("div",et,[t("div",{class:g(["btn edit-btn",[0,2].includes(s.data.status)?"disable":""]),onClick:o[0]||(o[0]=i=>n("editVideo"))},o[5]||(o[5]=[t("span",{class:"iconfont icon-edit"},null,-1),f("编辑 ")]),2),u(L,{class:"cust-popover",placement:"bottom-end",width:300,trigger:"hover","show-arrow":!1},{reference:m(()=>o[6]||(o[6]=[t("div",{class:"btn more-btn"},[t("span",{class:"iconfont icon-more"})],-1)])),default:m(()=>[t("div",st,[t("div",at,[t("div",{class:g(["more-edit-item",[0,2].includes(s.data.status)?"disable":""]),onClick:o[1]||(o[1]=i=>n("editVideo"))},o[7]||(o[7]=[t("div",{class:"iconfont icon-edit"},null,-1),t("div",{class:"title"},"编辑稿件",-1)]),2),t("div",{class:"more-edit-item",onClick:o[2]||(o[2]=i=>n("danmu"))},o[8]||(o[8]=[t("div",{class:"iconfont icon-danmu"},null,-1),t("div",{class:"title"},"弹幕管理",-1)])),t("div",{class:"more-edit-item",onClick:o[3]||(o[3]=i=>n("comment"))},o[9]||(o[9]=[t("div",{class:"iconfont icon-hudong"},null,-1),t("div",{class:"title"},"评论管理",-1)])),t("div",nt,[u(w,{modelValue:y.value,"onUpdate:modelValue":o[4]||(o[4]=i=>y.value=i),onChange:I},{default:m(()=>[u(N,{value:"0"},{default:m(()=>o[10]||(o[10]=[f("关闭弹幕")])),_:1}),u(N,{value:"1"},{default:m(()=>o[11]||(o[11]=[f("关闭评论")])),_:1})]),_:1},8,["modelValue"])])]),t("div",{class:"del-btn"},[t("span",{class:"iconfont icon-delete2",onClick:k},"删除稿件")])])]),_:1})])],512)}}},lt=U(it,[["__scopeId","data-v-ae535654"]]),dt={class:"video-tab"},ut={class:"search"},ct={class:"video-manage"},rt={class:"top-info"},vt={class:"all-video-panel"},mt={class:"count-info"},pt={class:"video-status"},ft={class:"count-info"},Ct={class:"count-info"},_t={class:"count-info"},kt={class:"video-list"},Vt={__name:"VideoList",setup(s){const{proxy:_}=S();q(),P();const l=V(),v=V(),d=r=>{v.value=r,c()},y=()=>{v.value=null,c()},I=V({}),c=async()=>{let r={pageNo:I.value.pageNo,videoNameFuzzy:l.value,status:v.value},e=await _.Request({url:_.Api.loadUcenterVideoList,params:r});e&&(I.value=e.data)};c();const n=V({inProgress:0,auditPassCount:0,auditFailCount:0}),x=async()=>{let r=await _.Request({url:_.Api.getUcenterVideoCountInfo});r&&(n.value=r.data)};x();let k=V(null);const C=()=>{k.value=setInterval(()=>{c(),x()},5e3)},o=()=>{k.value!==null&&(clearInterval(k.value),k.value=null)};return j(()=>{C()}),D(()=>{o()}),(r,e)=>{const N=p("el-input"),w=p("el-divider"),L=p("DataList");return $(),b(h,null,[t("div",dt,[e[5]||(e[5]=t("div",{class:"tab"},"视频管理",-1)),t("div",ut,[u(N,{clearable:"",placeholder:"搜索稿件",size:"small",modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=i=>l.value=i),onKeyup:T(c,["enter"])},{suffix:m(()=>e[4]||(e[4]=[t("span",{class:"iconfont icon-search"},null,-1)])),_:1},8,["modelValue"])])]),t("div",ct,[t("div",rt,[t("div",vt,[t("div",{class:"all-video",onClick:y},[e[6]||(e[6]=f(" 全部稿件")),t("span",mt,a(n.value.inProgress+n.value.auditPassCount+n.value.auditFailCount),1)])]),t("div",pt,[t("span",{class:g(["item",v.value==-1?"active":""]),onClick:e[1]||(e[1]=i=>d(-1))},[e[7]||(e[7]=f("进行中")),t("span",ft,a(n.value.inProgress),1)],2),u(w,{direction:"vertical"}),t("span",{class:g(["item",v.value==3?"active":""]),onClick:e[2]||(e[2]=i=>d(3))},[e[8]||(e[8]=f("已通过")),t("span",Ct,a(n.value.auditPassCount),1)],2),u(w,{direction:"vertical"}),t("span",{class:g(["item",v.value==4?"active":""]),onClick:e[3]||(e[3]=i=>d(4))},[e[9]||(e[9]=f("未通过")),t("span",_t,a(n.value.auditFailCount),1)],2)])]),t("div",kt,[u(L,{dataSource:I.value,onLoadData:c},{default:m(({data:i})=>[u(lt,{data:i,onReload:c},null,8,["data"])]),_:1},8,["dataSource"])])])],64)}}},Ht=U(Vt,[["__scopeId","data-v-ba509e71"]]);export{Ht as default};
