import{l as T,b as y,c as p,a as o,P as r,H as n,u as f,L as v,M as m,O as C,K as g,G as j,ag as l,o as d,a4 as G,V as N,I as F,Q as K,i as O}from"./@vue-JlwsckWB.js";import{V as P}from"./VideoSeriesEdit-OevDDw3A.js";import{l as Q}from"./vue-draggable-plus-N5Bk0sze.js";import{a as z,u as J}from"./vue-router-hI8gbx6m.js";import{_ as W,a as X}from"./index-D9sq5B9z.js";import"./pinia-91x-qzso.js";import"./vue-demi-Dq6ymT-8.js";import"./element-plus-BCXmXNOW.js";import"./lodash-es-DpRhkxuT.js";import"./@vueuse-DS8A98-V.js";import"./@element-plus-Dbr4-WMN.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-Cvt7qOjS.js";import"./artplayer-DYEsUqgO.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DVIT0l11.js";import"./axios-upsvKRUO.js";import"./vue-cookies-DmNBPvI0.js";import"./@fingerprintjs-BlNouByb.js";import"./tslib-BLN2B0TR.js";import"./vue-cropper-BAfMpYow.js";import"./mitt-DJ65BbbF.js";import"./moment-C5S46NFB.js";const Y={class:"video-list-panel"},Z={class:"video-title"},ee={class:"detail-panel"},se={class:"video-detail"},oe={class:"count-info"},te={class:"description"},ie={key:1,class:"list-item"},re=["onClick"],ae={key:0,class:"move-handler iconfont icon-move"},ne=["onClick"],le={class:"play-count-info"},de={class:"play-count iconfont icon-play2"},ue={class:"create-time"},ce={__name:"VideoSeriesDetail",setup(pe){const{proxy:s}=O(),V=z(),u=J(),R=X(),_=T(()=>R.userInfo.userId==u.params.userId),c=y({}),a=y([]),I=async()=>{let t=await s.Request({url:s.Api.uHomeSeriesGetVideoSeriesDetail,params:{seriesId:u.params.seriesId}});t&&(c.value=t.data.videoSeries,a.value=t.data.seriesVideoList,_.value&&a.value.unshift({seriesId:"add"}))};I();const $=async()=>{let t=a.value.map(S=>S.videoId);t.splice(0,1),await s.Request({url:s.Api.uHomeSeriesSaveSeriesVideo,params:{seriesId:u.params.seriesId,videoIds:t.join(",")}})&&s.Message.success("排序成功")},w=t=>{V.push(`/video/${t.videoId}`)},x=t=>{s.Confirm({message:`确定要删除【${t.videoName}】吗？`,okfun:async()=>{await s.Request({url:s.Api.uHomeSeriesDelSeriesVideo,params:{seriesId:u.params.seriesId,videoId:t.videoId}})&&(s.Message.success("删除成功"),I())}})},H=()=>{s.Confirm({message:`确定要删除【${c.value.seriesName}】吗？`,okfun:async()=>{await s.Request({url:s.Api.uHomeSeriesDelVideoSeries,params:{seriesId:u.params.seriesId}})&&(s.Message.success("删除成功"),V.push(`/user/${u.params.userId}/series`))}})},k=y(),L=()=>{k.value.show(c.value,1)},M=()=>{k.value.show(c.value,2)};return(t,e)=>{const S=l("router-link"),b=l("el-divider"),h=l("el-button"),q=l("Cover"),A=l("el-dropdown-item"),B=l("el-dropdown-menu"),E=l("el-dropdown"),U=l("NoData");return d(),p("div",Y,[o("div",Z,[r(S,{to:`/user/${f(u).params.userId}/series`,class:"a-link"},{default:n(()=>e[2]||(e[2]=[v("视频列表")])),_:1},8,["to"]),v(" > "+m(c.value.seriesName),1)]),o("div",ee,[o("div",se,[o("div",oe,[o("div",null,m(a.value.length)+"个视频",1),r(b,{direction:"vertical"}),o("div",null,m(f(s).Utils.formatDate(c.value.updateTime))+"更新",1)]),o("div",te,m(c.value.seriesDescription),1)]),_.value?(d(),p(C,{key:0},[r(h,{type:"primary",onClick:L},{default:n(()=>e[3]||(e[3]=[v("编辑")])),_:1}),r(h,{type:"danger",onClick:H},{default:n(()=>e[4]||(e[4]=[v("删除")])),_:1})],64)):g("",!0)]),r(f(Q),{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=i=>a.value=i),onUpdate:$,handle:".move-handler",class:"video-list",draggable:".list-item"},{default:n(()=>[(d(!0),p(C,null,G(a.value,(i,me)=>(d(),p(C,{key:i.seriesId},[i.seriesId=="add"?(d(),p("div",{key:0,class:"video-item-add",onClick:M},e[5]||(e[5]=[o("div",{class:"iconfont icon-add"},null,-1),o("div",{class:"add-info"},"添加视频",-1)]))):(d(),p("div",ie,[o("div",{class:"cover",onClick:D=>w(i)},[_.value?(d(),p("div",ae)):g("",!0),r(q,{source:i.videoCover},null,8,["source"])],8,re),o("div",{class:"list-name",onClick:D=>w(i)},m(i.videoName),9,ne),o("div",le,[o("div",de,m(i.playCount),1),o("div",ue,m(f(s).Utils.formatDate(i.createTime)),1),r(E,null,{dropdown:n(()=>[r(B,null,{default:n(()=>[r(A,{onClick:N(D=>x(i),["stop"])},{default:n(()=>e[6]||(e[6]=[v("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[F(o("div",{class:"iconfont icon-more",onClick:e[0]||(e[0]=N(()=>{},["stop"]))},null,512),[[K,_.value]])]),_:2},1024)])]))],64))),128))]),_:1},8,["modelValue"]),a.value.length==0?(d(),j(U,{key:0,msg:"暂无视频"})):g("",!0),r(P,{ref_key:"videoSeriesEditRef",ref:k,onReload:I},null,512)])}}},Te=W(ce,[["__scopeId","data-v-186928e2"]]);export{Te as default};
