import{u as C}from"./index-D9sq5B9z.js";import{u as L,a as D}from"./vue-router-hI8gbx6m.js";import{b as i,e as f,ag as v,o as V,c as h,P as y,H as M,i as S}from"./@vue-JlwsckWB.js";const b={class:"data-list"},k={__name:"VideoList",setup(x){const r=C(),{proxy:l}=S(),o=L();D();const n=r.categoryMap,d=i({}),_=(a,e)=>{let t="",c="";a&&(t=n[a]?n[a].categoryId:""),e&&(c=n[e]?n[e].categoryId:""),d.value={pCategoryId:t,categoryId:c}},u=i(!1),s=i({}),p=async()=>{let a={pageNo:s.value.pageNo};Object.assign(a,d.value),u.value=!0;let e=await l.Request({url:l.Api.loadVideo,params:a});if(u.value=!1,!e)return;const t=s.value.list;s.value=Object.assign({},e.data),e.data.pageNo>1&&(s.value.list=t.concat(e.data.list))},m=()=>{_(o.params.pCategoryCode,o.params.categoryCode),p()},g=i(!1);return f(()=>o.params,(a,e)=>{if(a){if(!g.value)return;r.setCureentPCategory(o.params.pCategoryCode),m()}},{immediate:!0,deep:!0}),f(()=>r.categoryMap,(a,e)=>{!a||Object.keys(a).length==0||(g.value=!0,r.setCureentPCategory(o.params.pCategoryCode),m())},{immediate:!0,deep:!0}),(a,e)=>{const t=v("VideoItem"),c=v("DataLoadMoreList");return V(),h("div",b,[y(c,{dataSource:s.value,loading:u.value,onLoadData:p},{default:M(({data:I})=>[y(t,{data:I,marginTop:20,ref:"videoItemRef"},null,8,["data"])]),_:1},8,["dataSource","loading"])])}}};export{k as _};
