import{a as D}from"./vue-router-hI8gbx6m.js";import{u as L}from"./navActionStore-yUvuvR1j.js";import{_ as N}from"./index-D9sq5B9z.js";import{b as v,j as w,c as x,a as o,P as r,H as u,ag as l,o as S,L as b,u as A,M,i as I}from"./@vue-JlwsckWB.js";import"./pinia-91x-qzso.js";import"./vue-demi-Dq6ymT-8.js";import"./element-plus-BCXmXNOW.js";import"./lodash-es-DpRhkxuT.js";import"./@vueuse-DS8A98-V.js";import"./@element-plus-Dbr4-WMN.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-Cvt7qOjS.js";import"./artplayer-DYEsUqgO.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DVIT0l11.js";import"./axios-upsvKRUO.js";import"./vue-cookies-DmNBPvI0.js";import"./@fingerprintjs-BlNouByb.js";import"./tslib-BLN2B0TR.js";import"./vue-cropper-BAfMpYow.js";import"./mitt-DJ65BbbF.js";import"./moment-C5S46NFB.js";const R={class:"history-list"},$={class:"top-info"},q={class:"data-list"},B={class:"history-item"},T=["onClick"],V={class:"video-info"},j=["onClick"],F={class:"op-btns"},U=["onClick"],E={__name:"History",setup(O){const{proxy:t}=I(),f=D(),c=L(),d=v(!1),i=v({}),m=async()=>{let s={pageNo:i.value.pageNo};d.value=!0;let e=await t.Request({url:t.Api.playHisotry,params:s});if(d.value=!1,!e)return;const n=i.value.list;i.value=Object.assign({},e.data),e.data.pageNo>1&&(i.value.list=n.concat(e.data.list))};m(),w(()=>{c.setShowHeader(!0),c.setFixedHeader(!0),c.setFixedCategory(!1),c.setShowCategory(!1)});const y=()=>{t.Confirm({message:"确定要清空历史记录吗？",okfun:async()=>{await t.Request({url:t.Api.cleanHistory})&&(t.Message.success("删除成功"),i.value={list:[]})}})},g=s=>{t.Confirm({message:"确定要删除记录吗？",okfun:async()=>{await t.Request({url:t.Api.delHistory,params:{videoId:s}})&&(t.Message.success("删除成功"),i.value.list=i.value.list.filter(n=>n.videoId!=s))}})},p=s=>{f.push(`/video/${s}`)};return(s,e)=>{const n=l("el-button"),C=l("Cover"),h=l("el-timeline-item"),k=l("DataLoadMoreList"),H=l("el-timeline");return S(),x("div",R,[o("div",$,[e[1]||(e[1]=o("div",{class:"iconfont icon-wating"},"历史记录",-1)),o("div",null,[r(n,{type:"primary",onClick:y},{default:u(()=>e[0]||(e[0]=[b("清空历史")])),_:1})])]),r(H,null,{default:u(()=>[o("div",q,[r(k,{dataSource:i.value,loading:d.value,onLoadData:m,layoutType:"line"},{default:u(({data:a})=>[r(h,{timestamp:A(t).Utils.formatDate(a.lastUpdateTime),placement:"top"},{default:u(()=>[o("div",B,[o("div",{class:"cover",onClick:_=>p(a.videoId)},[r(C,{source:a.videoCover},null,8,["source"])],8,T),o("div",V,[o("div",{onClick:_=>p(a.videoId)},M(a.videoName||s.已失效视频),9,j)]),o("div",F,[o("div",{class:"iconfont icon-delete",onClick:_=>g(a.videoId)},null,8,U)])])]),_:2},1032,["timestamp"])]),_:1},8,["dataSource","loading"])])]),_:1})])}}},vt=N(E,[["__scopeId","data-v-73eedb58"]]);export{vt as default};
